<!doctype html>
<html>
  <head>
    <title>Pictwo</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
  </head>
  <body>

    <div class="main-content">
      <div class="menu-screen">
        
    <div id="main-content" class="main-content">

      <div id="pseudo-screen" class="pseudo-screen">
        <img src="logo.jpg" class="logo">
        <form id="send-pseudo">
            <input id="pseudo-input" class="pseudo-input" autocomplete="off"/><button>Rejoindre</button>
          </form>
      </div>
        
      <!-- <div class="players-screen"></div> -->

      <div id="game-screen" class="game-screen hidden">
        <div class="drawer-div">
          <canvas height="500" width="500" id="canvas"></canvas>
          <span class="state">Lorem ipsum dolor sit</span>
        </div>

        <div class="tchat">
          <ul id="message-list" class="message-list"></ul>
          <form id="send-message">
            <input id="message-input" class="message-input" autocomplete="off"/><button>Envoyer</button>
          </form>
        </div>
      </div>

      <div class="endgame-screen hidden">
        
      </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      $(function () {
        var socket = io();


        //pseudo
        $('#send-pseudo').submit(function(){
          socket.emit('new-player', $('#pseudo-input').val());
          $('#pseudo-input').val('');
          return false;
        });

        // socket.on('join-room', function(){
        // });

        //receive only by the new user after sending pseud
        socket.on('game-joined', function(status){
          // hide and show right div
          $('#pseudo-screen').addClass('hidden');
          $('#game-screen').removeClass('hidden')

          if(status == 'DRAWER'){
            $('#main-content').addClass('drawer');
            $('#game-screen input, #game-screen button').prop('disabled', true);
          } else {
            $('#main-content').removeClass('drawer');
            $('#game-screen input, #game-screen button').prop('disabled', false);
          }
        });



        //messages
        $('#send-message').submit(function(){
          socket.emit('message', $('#message-input').val());
          $('#message-input').val('');
          return false;
        });

        socket.on('message', function(msg, user){
          console.log(user);
          console.log(msg);
          $('#message-list').append('<li><span class="username" style="color:' + user.color + '">' + user.name + ':</span> ' + msg +'</li>');
        });

        socket.on('special-message', function(msg){
          $('#message-list').append('<li class="special" style="background-color:'+msg.color+'">'+msg.content+'</li>');
        });





        socket.on('userConnected', function(myNick){
          $('#message-list').append('<li>' + myNick + ' s\'est connect√© ! </li>');
        })
      });
    </script>

  </body>
</html>